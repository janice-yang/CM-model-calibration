function [cells] = create_Kernik_cells(N, sigma, mu, init_Y)
%%%%%%
% Creates a population of Kernik19 model cells with varied parameters
% 
% Input:
%   init_Y = (numeric array) initial conditions
%       Default: init_Y = [-75.7444536163477,0.338969592726776,0.000203113729306209,7.16928093750999,104.748824394112,0,0.000386686486786781,0.165948056753057,0.927145173320106,0.321984775889061,0.452222061313948,0.157787210225653,0.743251868606151,0.121059208476135,0.0292207648412020,0.00620538308203812,0.736108314102295,0.000264118925707198,0.000263623380304203,0.746780367359425,0.0122283684412607,0.000154416932298621,0.0123158737520428,0] ;
%   N = (int) population size
%   sigma = (numeric) population standard deviation (log-normal)
%   mu = (numeric, optional) population mean; default is zeros(1, 16)
%
% Output:
%   cells = (cell array of gaKernik19 objects)
%%%%%%

% Use baseline Kernik parameters as mean if none supplied
if ~exist('mu','var')
    mu = zeros(1, 16) ;
end

if ~exist('init_Y', 'var')
    init_Y = [-75.7444536163477,0.338969592726776,0.000203113729306209,7.16928093750999,104.748824394112,0,0.000386686486786781,0.165948056753057,0.927145173320106,0.321984775889061,0.452222061313948,0.157787210225653,0.743251868606151,0.121059208476135,0.0292207648412020,0.00620538308203812,0.736108314102295,0.000264118925707198,0.000263623380304203,0.746780367359425,0.0122283684412607,0.000154416932298621,0.0123158737520428,0] ;
end

rng(0) % Set random number generator seed for reproducibility
cells = cell(1,N);
for i=1:N % 
    x_conductances = mu ;
    for j=1:length(mu)
        x_conductances(j) = exp(sigma .* randn + mu(j)) ;
    end
    k19 = gaKernik19([-75.7444536163477,0.338969592726776,0.000203113729306209,7.16928093750999,104.748824394112,0,0.000386686486786781,0.165948056753057,0.927145173320106,0.321984775889061,0.452222061313948,0.157787210225653,0.743251868606151,0.121059208476135,0.0292207648412020,0.00620538308203812,0.736108314102295,0.000264118925707198,0.000263623380304203,0.746780367359425,0.0122283684412607,0.000154416932298621,0.0123158737520428,0], ...
           i) ; % requires "cellID" - just using cell # here
    scaleCell(k19, x_conductances, ones(1,58)) ;
    cells{i} = k19 ;
end


end