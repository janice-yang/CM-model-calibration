%{
Cardiac model ToR-ORd
Copyright (C) 2019 Jakub Tomek. Contact: jakub.tomek.mff@gmail.com

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.
%}
function init_Y = f_getInit_Y(celltype_str, iso, pace) % iso and pace are optional
% A function returning initial state for various models. Currently only 3
% variants are present, for endo/epi/midmyocardial ToR-ORd, but further ones
% may be added

if (strcmp(celltype_str, 'endo')) % 0
    %old inits init_Y = [-88.8691566357934,12.0996647655188,12.1000028563765,142.412524737626,142.412481425842,7.45541572746214e-05,6.50418928341426e-05,1.53037019085812,1.52803094224238,0.000787657400526199,0.674096901201792,0.830658198588696,0.830466744399495,0.830093612199637,0.000159670117055769,0.528261721740178,0.288775833197764,0.000944249645410894,0.999616956857814,0.593680589620082,0.000481107253796778,0.999616964658062,0.654092074678260,8.86091322819384e-29,0.999999992783113,0.938965241412012,0.999999992783179,0.999900458262832,0.999977476316330,0.000492094765239740,0.000833711885764158,0.999999992566681,0.999999992766279,0.247156543918935,0.000175017075236424,3.90843796133124e-24,0.0110752904836162,0.998073652444028,0.000844745297078649,0.000698171876592920,0.000370404872169913,1.30239063420973e-05,-1.88428892080206e-22 0];
    init_Y=[-89.2281285794093,13.9962537976954,13.9968532017649,142.377594339166,142.377513094527,9.54187198459965e-05,8.47030596713313e-05,1.90831902995765,1.64216679985934,0.000729053159763137,0.685157945956353,0.837363938805539,0.800008255704880,0.740690247235367,0.000149146305617174,0.387220277840237,0.189904144894791,0.000921815697866492,0.999638724766404,0.235738966760115,0.000469671698064924,0.999638957194830,0.289150490336798,-6.48804511712033e-28,0.999999993407457,0.853440136465043,0.999999993409308,0.984073997723434,0.975606905585273,0.00140823335561714,0.00221983755540423,0.999994777166225,0.999999606696603,0.408871507410702,0.000243221250589526,-2.11639091238893e-21,0.0682838377652020,0.903477331832434,0.000766493729007316,0.00636501792466111,0.0863980065531772,0.00299314835108257,-1.08909392934118e-19,0];
elseif (strcmp(celltype_str, 'epi')) % 1
    init_Y = [-89.0154768721342,12.8382605269815,12.8386296068886,142.460122044002,142.460073757800,7.44971662963012e-05,6.38115248479545e-05,1.83376662673169,1.83451041520486,0.000763228908104755,0.678841695234194,0.833544909403616,0.833497781389367,0.833311768661844,0.000155293652653466,0.536468471494865,0.300980562176301,0.000934977025106033,0.999626696605431,0.999623652971323,0.000476380566651530,0.999626696659922,0.999626199062997,3.44090020293841e-37,0.999999993064605,0.948443428743038,0.999999993064610,0.999933400688481,0.999981769973542,0.000456804180120420,0.000830893014440888,0.999999993064818,0.999999993064276,0.232708882444918,0.000172120093619941,4.14953854790051e-24,0.0129726050063671,0.998185994327463,0.000836058850210933,0.000685608512717355,0.000282493081467249,9.84492151787658e-06,1.70514183624061e-22 0];
elseif (strcmp(celltype_str, 'mid')) % 2
    init_Y = [-88.9590090659588,14.9968170642505,14.9974341914714,142.625375608671,142.625316420398,9.17163015407947e-05,7.25139659488411e-05,1.94322774406231,1.95039622434061,0.000772566809118471,0.677013343047248,0.832434326858963,0.832290316009961,0.831808572855801,0.000156968260425169,0.527174936474434,0.280556044033432,0.000938545400571819,0.999622955471138,0.568989935607894,0.000478199529001736,0.999622960224351,0.627685396742549,5.59921706285619e-28,0.999999992950244,0.921126200688429,0.999999992957103,0.999799367958552,0.999967255695472,0.000748915074620697,0.00184513039130798,0.999999992835124,0.999999992956490,0.264964501338528,0.000173243302385262,2.12311882737393e-20,0.0187898657397651,0.997900476271853,0.000839251201866205,0.000704846358850060,0.000536619999494324,1.88036392748250e-05,9.41901389088170e-19 0];
else
    error('Please choose ''endo'', ''epi'' or ''mid'' as your argument')
end

if exist('iso', 'var') && exist('pace', 'var')
    if iso
        if (strcmp(celltype_str, 'endo')) % 0
            % each of these was generated by running a single baseline cell
            % for 5000 beats at the given pacing rate with iso, starting
            % from the initial conditions above (i.e. no iso)
            if pace < 2.5
                %warning('Long term iso at this rate may lead to alternans or EADs')
                init_Y = [-97.4757730585130,14.1667190639856,14.1672219294973,183.153619960352,183.153438914870,6.79283927507576e-05,6.63549562617879e-05,4.50511307966156,4.12452451067086,0.000121222453358809,0.777353915217371,0.890251242842173,0.929391286842695,0.895259621519623,3.11322246121355e-05,0.479433376845186,0.293457081342980,0.000528562074861813,0.999914815423454,0.225352507498531,0.000269254177688676,0.999914879630615,0.280484593848375,4.44855978117365e-41,0.999999993839738,0.786538065193718,0.999999993843903,0.938389314761651,0.966578351310135,0.000558622902863909,0.000608575412954929,0.999974426586335,0.999995880263794,0.529077682565076,0.000116355115845986,-1.49485256241160e-26,0.317904186102003,0.927018767004054,0.000438761705745979,0.00650342288510497,0.0645924763845797,0.00144657028064216,1.40563855314118e-22,0];
            elseif pace >= 2.5 && pace < 3
                init_Y = [-97.4415165028503,14.3153599868236,14.3158624846949,181.976092898967,181.975901509631,6.82753878289960e-05,6.50652922769796e-05,4.67167390653571,4.38188997918328,0.000122135458897495,0.776524305580445,0.889797628677890,0.933435271621296,0.907331543504853,3.13354741143217e-05,0.525757994894386,0.309140408184809,0.000529771429135199,0.999914377778942,0.248090793878005,0.000269870393608296,0.999914426201101,0.318386618442600,-1.05767748778099e-41,0.999999993794181,0.806766786102371,0.999999993794855,0.968409850785747,0.979072370825543,0.000509325503305172,0.000611074840782955,0.999991060788564,0.999999050849398,0.540451167427495,8.32572123267899e-05,-5.54003909358026e-27,0.314145731519437,0.946504719125430,0.000445030127444735,0.00484120635481440,0.0471511892672456,0.00105785355774104,9.47290417048676e-26,0];
            elseif pace >= 3 && pace < 3.5
                init_Y = [-97.4915825983388,14.7736555745211,14.7743793177175,181.825484173365,181.825274989494,8.39804664032693e-05,8.49550171442677e-05,5.07668197788516,4.50679362117335,0.000120802412681374,0.777634301999978,0.890404455863719,0.911215186772265,0.853894661901151,3.10387058674853e-05,0.451934340316093,0.264109300755611,0.000528071717447259,0.999914633787537,0.196277685092069,0.000269004320558552,0.999914788906579,0.257096139206260,1.75402434947632e-29,0.999999993587447,0.785214304880041,0.999999993820978,0.951854890288624,0.955385082476651,0.00147816418396966,0.00140497859225270,0.999868544571092,0.999983182837863,0.576391666984340,0.000250919635933076,-1.02842689540005e-20,0.382351006422356,0.887017603115012,0.000427604397432683,0.00990332528951012,0.100404449589055,0.00224701599053867,-1.28808427420095e-19,0];
            elseif pace >= 3.5
                init_Y = [-97.2242460357967,15.0917354195233,15.0928314065776,180.805669387519,180.805449516446,0.000107739152264128,0.000115750976025645,5.36576552296400,4.44240717342260,0.000128094867105775,0.770665896621625,0.886583438270179,0.860458321514070,0.768994450130847,3.26565611047363e-05,0.382083302154799,0.220670155966086,0.000537849784711254,0.999909497466349,0.158021029734658,0.000273986668007404,0.999909910054095,0.209760171388087,-2.12802226683215e-30,0.999999968206892,0.765088973551303,0.999999992811019,0.934972775578735,0.925525730038304,0.00501770017062100,0.00379621057868430,0.999161505921932,0.999873588202655,0.603852078034535,0.00107092084440411,5.40856990471302e-20,0.434614548931996,0.808839532969455,0.000413994299439473,0.0163464315648065,0.170528142992126,0.00387189651603337,1.92310756396485e-16,0];
            end
            
        end
    end
end


end